#ifndef EXPLOITS_H
#define EXPLOITS_H

#include <libbelladonna.h>

#include <exploits/checkm8/checkm8.h>

/* All this code is to enable easy addition of exploits to belladonna, simply provides an easy generic way to specify the exploits */
typedef int(*exploit_t)(belladonna_ctx_t ctx);

typedef struct {
	const char* name;
	exploit_t supported;
	exploit_t exploit;
} exploit_decl_t;

#define CHECKM8_DECL (exploit_decl_t){.name = "checkm8", .supported=checkm8_supported, .exploit=checkm8_exploit}

static exploit_decl_t exploits[] = {CHECKM8_DECL};
static size_t exploits_len = sizeof(exploits) / sizeof(exploit_decl_t);

#endif