CROSS = arm-none-eabi-
AS = $(CROSS)as
OBJCOPY = $(CROSS)objcopy
BIN2C = bin2c
RM = rm
PYTHON = python
ASFLAGS = -mthumb -mlittle-endian --fatal-warnings 
OBJECTS = checkm8_armv7.bin usb_0xA1_2_armv7.bin

.PHONY: checkm8_payload

%.bin: %.S
	@echo AS -c $(<) -o $(@)
	@$(AS) $(ASFLAGS) -c $(<) -o a.o 
	@$(OBJCOPY) -O binary a.o $(@) 
	@$(RM) a.o

checkm8_payload: $(OBJECTS)
	@$(BIN2C) checkm8_armv7.bin checkm8_exploit_payload.h checkm8_exploit_payload
	@$(BIN2C) usb_0xA1_2_armv7.bin checkm8_handler_payload.h checkm8_handler_payload

all: checkm8_payload


clean:
	@$(RM) -rf *.bin
	@$(RM) -rf *.h

distdir:
install:
install-data:
install-exec:
uninstall:
install-dvi:
install-html:
install-info:
install-ps:
install-pdf:
installdirs:
mostlyclean: clean
distclean: clean
maintainer-clean: clean
dvi:
pdf:
ps:
info:
html:
tags:
ctags: